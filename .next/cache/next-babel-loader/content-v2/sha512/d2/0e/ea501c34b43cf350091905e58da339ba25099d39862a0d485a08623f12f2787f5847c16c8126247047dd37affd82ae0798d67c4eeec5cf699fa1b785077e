{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"E:\\\\projects\\\\4.23\\\\awake-nextjs-refactored1\\\\src\\\\components\\\\common\\\\loading\\\\index.tsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { Player } from '@lottiefiles/react-lottie-player';\nimport cookieCutter from 'cookie-cutter';\nimport { useAuth } from 'context/auth';\nimport { findDevServerUrl, loadedUrl } from 'utils/axios-client';\nimport loadingAnimation from './loading-animation.json';\n/**\r\n * App Loading screen.\r\n */\n\nvar Loading = function Loading(_ref) {\n  _s();\n\n  var children = _ref.children;\n\n  var _useState = useState(false),\n      isAuthLoaded = _useState[0],\n      setAuthLoaded = _useState[1];\n\n  var _useAuth = useAuth(),\n      jwt = _useAuth.jwt,\n      fetchUser = _useAuth.fetchUser,\n      logout = _useAuth.logout;\n\n  useEffect(function () {\n    findDevServerUrl().then(function (url) {\n      cookieCutter.set('server-url', url);\n      return;\n    })[\"finally\"](function () {\n      setAuthLoaded(true);\n\n      if (loadedUrl) {\n        if (jwt) {\n          fetchUser();\n        }\n      }\n    })[\"catch\"](function (e) {\n      var _e$response, _e$response$data;\n\n      console.error('Error on load', e);\n\n      if ((e === null || e === void 0 ? void 0 : (_e$response = e.response) === null || _e$response === void 0 ? void 0 : (_e$response$data = _e$response.data) === null || _e$response$data === void 0 ? void 0 : _e$response$data.statusCode) === 'unauthorised') {\n        logout(); // dispatchModal({\n        //     type: 'add',\n        //     modal: <ModalError text={getLanguage().youWereLoggedOut} />\n        // })\n      }\n    });\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: isAuthLoaded ? children : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"centerLoading\",\n      children: /*#__PURE__*/_jsxDEV(Player, {\n        autoplay: true,\n        loop: true,\n        src: loadingAnimation,\n        style: {\n          height: 400,\n          width: 400\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 49,\n        columnNumber: 11\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 9\n    }, _this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 44,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(Loading, \"ldFe9nWLQ7w/GtlIdHKGAPHfZUg=\", false, function () {\n  return [useAuth];\n});\n\n_c = Loading;\nexport default Loading;\n\nvar _c;\n\n$RefreshReg$(_c, \"Loading\");","map":{"version":3,"sources":["E:/projects/4.23/awake-nextjs-refactored1/src/components/common/loading/index.tsx"],"names":["React","useEffect","useState","Player","cookieCutter","useAuth","findDevServerUrl","loadedUrl","loadingAnimation","Loading","children","isAuthLoaded","setAuthLoaded","jwt","fetchUser","logout","then","url","set","e","console","error","response","data","statusCode","height","width"],"mappings":";;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;AACA,SAASC,MAAT,QAAuB,kCAAvB;AACA,OAAOC,YAAP,MAAyB,eAAzB;AAEA,SAASC,OAAT,QAAwB,cAAxB;AACA,SAASC,gBAAT,EAA2BC,SAA3B,QAA4C,oBAA5C;AAEA,OAAOC,gBAAP,MAA6B,0BAA7B;AAEA;AACA;AACA;;AACA,IAAMC,OAAO,GAAG,SAAVA,OAAU,OAAuB;AAAA;;AAAA,MAApBC,QAAoB,QAApBA,QAAoB;;AAAA,kBACCR,QAAQ,CAAC,KAAD,CADT;AAAA,MAC9BS,YAD8B;AAAA,MAChBC,aADgB;;AAAA,iBAEFP,OAAO,EAFL;AAAA,MAE7BQ,GAF6B,YAE7BA,GAF6B;AAAA,MAExBC,SAFwB,YAExBA,SAFwB;AAAA,MAEbC,MAFa,YAEbA,MAFa;;AAIrCd,EAAAA,SAAS,CAAC,YAAM;AACdK,IAAAA,gBAAgB,GACbU,IADH,CACQ,UAACC,GAAD,EAAS;AACbb,MAAAA,YAAY,CAACc,GAAb,CAAiB,YAAjB,EAA+BD,GAA/B;AACA;AACD,KAJH,aAKW,YAAM;AACbL,MAAAA,aAAa,CAAC,IAAD,CAAb;;AACA,UAAIL,SAAJ,EAAe;AACb,YAAIM,GAAJ,EAAS;AACPC,UAAAA,SAAS;AACV;AACF;AACF,KAZH,WAaS,UAACK,CAAD,EAAO;AAAA;;AACZC,MAAAA,OAAO,CAACC,KAAR,CAAc,eAAd,EAA+BF,CAA/B;;AACA,UAAI,CAAAA,CAAC,SAAD,IAAAA,CAAC,WAAD,2BAAAA,CAAC,CAAEG,QAAH,gFAAaC,IAAb,sEAAmBC,UAAnB,MAAkC,cAAtC,EAAsD;AACpDT,QAAAA,MAAM,GAD8C,CAEpD;AACA;AACA;AACA;AACD;AACF,KAtBH;AAuBD,GAxBQ,EAwBN,EAxBM,CAAT;AA0BA,sBACE;AAAA,cACGJ,YAAY,GACXD,QADW,gBAGX;AAAK,MAAA,SAAS,EAAC,eAAf;AAAA,6BACE,QAAC,MAAD;AACE,QAAA,QAAQ,MADV;AAEE,QAAA,IAAI,MAFN;AAGE,QAAA,GAAG,EAAEF,gBAHP;AAIE,QAAA,KAAK,EAAE;AACLiB,UAAAA,MAAM,EAAE,GADH;AAELC,UAAAA,KAAK,EAAE;AAFF;AAJT;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA;AAJJ;AAAA;AAAA;AAAA;AAAA,WADF;AAmBD,CAjDD;;GAAMjB,O;UAE+BJ,O;;;KAF/BI,O;AAmDN,eAAeA,OAAf","sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport { Player } from '@lottiefiles/react-lottie-player'\r\nimport cookieCutter from 'cookie-cutter'\r\n\r\nimport { useAuth } from 'context/auth'\r\nimport { findDevServerUrl, loadedUrl } from 'utils/axios-client'\r\n\r\nimport loadingAnimation from './loading-animation.json'\r\n\r\n/**\r\n * App Loading screen.\r\n */\r\nconst Loading = ({ children }: any) => {\r\n  const [isAuthLoaded, setAuthLoaded] = useState(false)\r\n  const { jwt, fetchUser, logout } = useAuth()\r\n\r\n  useEffect(() => {\r\n    findDevServerUrl()\r\n      .then((url) => {\r\n        cookieCutter.set('server-url', url)\r\n        return\r\n      })\r\n      .finally(() => {\r\n        setAuthLoaded(true)\r\n        if (loadedUrl) {\r\n          if (jwt) {\r\n            fetchUser()\r\n          }\r\n        }\r\n      })\r\n      .catch((e) => {\r\n        console.error('Error on load', e)\r\n        if (e?.response?.data?.statusCode === 'unauthorised') {\r\n          logout()\r\n          // dispatchModal({\r\n          //     type: 'add',\r\n          //     modal: <ModalError text={getLanguage().youWereLoggedOut} />\r\n          // })\r\n        }\r\n      })\r\n  }, [])\r\n\r\n  return (\r\n    <div>\r\n      {isAuthLoaded ? (\r\n        children\r\n      ) : (\r\n        <div className=\"centerLoading\">\r\n          <Player\r\n            autoplay\r\n            loop\r\n            src={loadingAnimation}\r\n            style={{\r\n              height: 400,\r\n              width: 400,\r\n            }}\r\n          />\r\n        </div>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Loading\r\n"]},"metadata":{},"sourceType":"module"}